<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="description" content="Recreating the common background effect seen on many crypto-currency websites">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://timmeier.io/posts/constellations/">
    <meta property="og:title" content="Constellations Effect - Tim Meier">
    <meta property="og:description" content="Recreating the common background effect seen on many crypto-currency websites">
    <meta property="og:image" content="/assets/socials.png">
    <meta property="twitter:card" content="summary">
    <meta property="twitter:url" content="https://timmeier.io/posts/constellations/">
    <meta property="twitter:title" content="Constellations Effect - Tim Meier">
    <meta property="twitter:description" content="Recreating the common background effect seen on many crypto-currency websites">
    <meta property="twitter:image" content="/assets/socials.png">

    <title>Constellations Effect - Tim Meier</title>
    <link rel="preload" href="/assets/goudybookletter1911-regular-webfont.woff2" type="font/woff2" as="font" crossorigin="anonymous">
    <link rel="preload" href="/assets/timtura.woff2" type="font/woff2" as="font" crossorigin="anonymous">
    <link rel="icon" type="image/png" sizes="16x16" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAABlBMVEUAAAD///+l2Z/dAAAAH0lEQVQI12NgYGCo/wdCCWwglFfGUFeHjmrsoGoYGABK/Q5HriOGrgAAAABJRU5ErkJggg==">
    <style>
    
    @font-face {
  font-family: 'Goudy Bookletter 1911';
  font-style: normal;
  font-weight: 400;
  src: url("/assets/goudybookletter1911-regular-webfont.woff2") format("woff2");
  font-display: swap; }

@font-face {
  font-family: 'Timtura';
  font-style: normal;
  font-weight: 400;
  src: url("/assets/timtura.woff2") format("woff2");
  font-display: swap; }

* {
  box-sizing: border-box;
  line-height: 1.4; }

html {
  background-image: linear-gradient(to right, #463924, #4d3e29, #463924);
  min-height: 100vh; }

body {
  width: 100%;
  min-height: 100vh;
  margin: 0;
  padding: 1rem 0 3rem;
  background-image: radial-gradient(circle at top, #dfccb4, #463924);
  background-color: #423b30;
  background-attachment: fixed;
  font-family: 'Timtura', sans-serif; }
  @media (min-width: 54rem) {
    body {
      padding-top: 2rem; } }

footer {
  width: 100%;
  position: fixed;
  bottom: 0;
  z-index: 1;
  padding: 0.25rem;
  text-align: center;
  color: black; }
  @media (min-width: 54rem) {
    footer {
      color: #221f1a; } }

iframe {
  width: 100%;
  height: 30rem;
  border: 1px dashed #888;
  border-radius: 0.5rem;
  margin-bottom: 1rem; }
  @media (max-width: 530px) {
    iframe {
      height: 20rem; } }
  iframe:last-child {
    margin-bottom: 0; }

h1 {
  margin: 0 0 1rem;
  color: #4f463c;
  font-family: 'Goudy Bookletter 1911', serif;
  font-weight: normal;
  font-size: 1.75rem;
  text-shadow: 0 -1px 2px rgba(0, 0, 0, 0.3), 0 2px 2px white; }
  h1 > a::after {
    content: '';
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0; }

p {
  font-size: 0.825rem;
  margin-top: 0; }
  p:last-child {
    margin-bottom: 0; }
  @media (min-width: 27rem) {
    p {
      font-size: 1rem; } }

ul {
  font-size: 0.825rem;
  padding-left: 1.5rem; }
  @media (min-width: 27rem) {
    ul {
      font-size: 1rem; } }

li {
  margin-bottom: 0.5rem; }

a {
  color: #6a420f;
  text-decoration: none; }
  a:link {
    text-decoration-line: underline;
    text-decoration-style: dotted;
    text-decoration-thickness: 1px;
    text-underline-offset: 0.1em; }
  a:visited {
    color: #6a420f; }
  a:hover, a:focus {
    color: #8b5a10;
    text-decoration-style: solid; }
  a:active {
    color: #8b5a10; }

.article-card {
  background: #f0edea;
  border: 2px solid;
  border-color: #ffffff #e8e8e8 #98999f;
  box-shadow: 0 1em 2em rgba(0, 0, 0, 0.5);
  transition: all 0.2s;
  width: 25rem;
  height: 18rem;
  flex: 0 1 auto;
  padding: 1.2rem;
  margin: 1rem;
  margin-bottom: 0;
  position: sticky;
  z-index: 2;
  border-radius: 0.4rem; }
  @media (min-width: 54rem) {
    .article-card {
      box-shadow: 0 1.5px 1.5px rgba(0, 0, 0, 0.056), 0 3.5px 3.5px rgba(0, 0, 0, 0.081), 0 6.6px 6.6px rgba(0, 0, 0, 0.1), 0 11.8px 11.8px rgba(0, 0, 0, 0.119), 0 22.1px 22.1px rgba(0, 0, 0, 0.144), 0 53px 53px rgba(0, 0, 0, 0.2); } }
  .article-card:first-child {
    margin-top: 0; }
  .article-card:nth-child(1) {
    top: 1rem; }
  .article-card:nth-child(2) {
    top: 2rem; }
  .article-card:nth-child(3) {
    top: 3rem; }
  .article-card:nth-child(4) {
    top: 4rem; }
  .article-card:nth-child(5) {
    top: 5rem; }
  .article-card:nth-child(6) {
    top: 6rem; }
  .article-card:nth-child(7) {
    top: 7rem; }
  .article-card:nth-child(8) {
    top: 8rem; }
  .article-card:nth-child(9) {
    top: 9rem; }
  .article-card:nth-child(10) {
    top: 10rem; }
  @media (min-width: 27rem) {
    .article-card {
      padding: 1.5rem 2rem;
      margin-bottom: 1rem; }
      .article-card:first-child {
        margin-top: 1rem; } }
  @media (min-width: 54rem) {
    .article-card {
      position: relative;
      border-radius: 0.25rem;
      margin-bottom: 1rem; }
      .article-card:nth-child(n) {
        top: unset; } }
  .article-card > p > img {
    width: 45%;
    height: 45%;
    object-fit: cover;
    float: right;
    margin-left: 0.5rem;
    border: 1px dashed #888; }
    @media (min-width: 27rem) {
      .article-card > p > img {
        width: 45%;
        height: 45%;
        margin-left: 1rem; } }
  @media (min-width: 54rem) {
    .article-card.title-link:hover {
      width: 25.3rem;
      height: 18.3rem;
      padding: 1.65rem 2.15rem;
      margin: 0.85rem;
      box-shadow: 0 2.9px 2.9px rgba(0, 0, 0, 0.056), 0 7px 7px rgba(0, 0, 0, 0.081), 0 13.1px 13.1px rgba(0, 0, 0, 0.1), 0 23.5px 23.5px rgba(0, 0, 0, 0.119), 0 43.9px 43.9px rgba(0, 0, 0, 0.144), 0 105px 105px rgba(0, 0, 0, 0.2); } }

.article-post {
  width: calc(100% - 2 * 1rem);
  max-width: 44rem;
  padding: 1.2rem;
  margin: 0 auto;
  position: relative;
  z-index: 2;
  background: #f0edea;
  border: 2px solid;
  border-radius: 0.25rem;
  border-color: #ffffff #e8e8e8 #98999f;
  box-shadow: 0 1em 2em rgba(0, 0, 0, 0.5); }
  @media (min-width: 54rem) {
    .article-post {
      padding: 2rem 4rem 3.5rem;
      box-shadow: 0 1.5px 1.5px rgba(0, 0, 0, 0.056), 0 3.5px 3.5px rgba(0, 0, 0, 0.081), 0 6.6px 6.6px rgba(0, 0, 0, 0.1), 0 11.8px 11.8px rgba(0, 0, 0, 0.119), 0 22.1px 22.1px rgba(0, 0, 0, 0.144), 0 53px 53px rgba(0, 0, 0, 0.2); } }
  .article-post > p:first-child {
    margin-bottom: 0; }
  .article-post > p > img {
    width: 100%;
    border: 1px dashed #888;
    border-radius: 0.5rem;
    margin-bottom: 1rem; }
    .article-post > p > img:last-child {
      margin-bottom: 0; }

.spacer-card {
  width: 25rem;
  height: calc(100vh - 20rem);
  flex: 0 1 auto;
  margin: 1rem; }
  @media (min-width: 54rem) {
    .spacer-card {
      display: none; } }

.card-container {
  margin: auto;
  position: relative;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  width: 100%; }
  @media (min-width: 27rem) {
    .card-container {
      max-width: 27rem; } }
  @media (min-width: 54rem) {
    .card-container {
      max-width: 54.1rem; } }
  @media (min-width: 81rem) {
    .card-container {
      max-width: 81.1rem; } }

    </style>
</head>
<body>
    <article class="article-post">
    <p><a href="/">return to index</a></p>
    <h1>Constellations Effect</h1>
<iframe src="/demos/constellations/index.html"></iframe>
<p>I've seen this effect a few times on websites that want to appear high-tech.
I don't know the real name for it, so I call it &quot;constellations&quot; as it looks
like stars connected to form abstract shapes. For a better impression
<a href="/demos/constellations/index.html">open the demo in full screen view.</a></p>
<p>My first attempt at replicating it was quite innefficient, (although I did
use techniquies such as keeping the stars in a grid that limited the number
of neighbouring stars they had to each loop through) so over time I made a
few improvements and learnt a few quirks of Canvas 2d drawing along the way:</p>
<ul>
<li>At first I had been clearing the canvas with <code>clearRect</code>; this sets an area
of pixels to <code>rgba(0,0,0,0)</code> (transparent black). I then drew semi-transparent
lines over that, which becomes slow due to the browser having to repeatedly
mix two different transparent colours together as the lines get drawn.
It turned out to be faster to fill the canvas with solid white, which was
faster to draw transparent colour onto.</li>
<li>The next improvement I made was to swap from concatenating a string of
<code>rgba()</code> values to keeping a constant black colour and only manipulating the
global alpha of the drawing context. This meant not having to concatenate a
string and values for every line drawn, but also not making the browser parse
that string into a colour. Global alpha is also set directly with a number,
without mucking about with strings, which is another bit of efficiency.</li>
<li>The transparency of the lines drawn varies based on distance between points;
further away stretches the line thin until it disappears completely. I was
using alpha transparency to accomplish this, but found that it was faster
to literally draw thinner lines at solid black. Presumably the same line drawing
algorithm is used whether the lines are 1px wide or not, which means removing
transparency can only speed things up.</li>
<li>Finally, I had implemented some interaction by making the &quot;stars&quot; dodge away
from the mouse cursor if they were too close. Due to the inherent delay in
passing mouse inputs through to the program, this felt a little laggy. However,
at the time I was reading the mouse position, updating star positions, and then
moving any stars that were too close to the mouse. This effectively meant they
were reacting to where the mouse was on the previous frame - if instead I
detected mouse proximity <em>before</em> updating the stars from their own velocity,
I effectively removed 1 frame of mouse lag, which can feel like a big difference.</li>
</ul>
<p>Of course, all of these changes are rather inconsequential against what could be
the biggest improvement: rewriting the rendering to use webGL instead of canvas
operations. At the moment, however, I'm happy to let it stay as it is.</p>

</article>
    <footer>
        made by Tim Meier using 11ty
    </footer>
</body>
</html>